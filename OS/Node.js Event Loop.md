# Node.js의 장점 및 동작원리

## **1. 이벤트 기반 ( Event-Driven) - 이벤트 루프 동작원리**

- 이벤트가 발생했을 때, 저장해둔 작업을 수행하는 방식
- 이벤트 리스너에 미리 콜백함수를 저장해 놓고, 입력된 이벤트에 따라 해당하는 작업을 수행한다.
- 발생한 이벤트는 순차적으로 처리하며, 발생한 이벤트가 없다면 대기한다.
- **이벤트 루프**가 이벤트 처리 순서를 관리해줌.

### (1) 이벤트 루프

- 이벤트 발생 시, 콜백함수를 관리하고, 실행 순서를 관리하는 역할
- **Task Queue** : 이벤트 발생 후, 실행되어야 하는 작업들이 순차적으로 대기하는 공간
- **Background** : Timer, I/O, 이벤트 리스너 등

### 전체적인 호출 스택 순서

1. 먼저 실행 코드들이 호출스택에 쌓인다.
2. 실행 코드 중 Background가 필요한 작업은 Background 공간으로 이동, 순차적으로 호출 스택이 진행된다.
3. 백그라운드에서 자체적으로 작업이 완료된 콜백함수는 Task Queue로 이동하여 대기.
4. 호출 스택들이 완료되면 이벤트 루프가 Task Queue에 있는 콜백을 순서대로 호출 스택에 올림.
5. 호출 스택이 완료되면 이벤트 루프가 돌면서 Task Queue에 있는 콜백을 실행시킨다.
6. Task Queue에 아무것도 없다면, 이벤트가 올때까지 대기한다.

## **2. 논블로킹 I/O ( Non-Blocking I/O)**

- 이전 작업이 완료될 때 까지 기다리면서 멈추지 않고 다음 작업이 지연되지 않게 동작하는 패러다임.
- 오래 걸리는 작업은 Background에서 진행하며 완료 후, 이벤트 루프를 통해 Task Queue를 거쳐 호출 스택에 올라오길 기다리는 방식
- 다른 컴퓨팅 자원에 접근하는 I/O에서 논블로킹 방식으로 채택됨.
- **비동기 개념**

## **3. 싱글 스레드**

ex) 주방(요리) = I/O, 점원 = 스레드, 고객 = 요청

![thread_photo](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FVsBiu%2Fbtqv7h6bGLL%2FFCYUV7q82MrAiwEjQFLP10%2Fimg.png)

- 점원(스레드)은 한명이지만, 주방(요리) 작업은 **논블로킹 작업으로 Background에서 작업**하므로, 고객(요청)이 대기하지 않아도, 바로 주문이 가능하며 주문 후, 요리가 완료되면 바로바로 서빙이 된다.
